___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "SEO Sessions (for GA4)",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "Triggers an event in dataLayer every time it detects that it is a new visit from a search engine.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "pushedEventName",
    "displayName": "Event Name (in dataLayer)",
    "simpleValueType": true,
    "help": "Write the name of the event as it will arrive at the dataLayer each time a new SEO visit occurs",
    "defaultValue": "ik_seo_session",
    "valueHint": "ik_seo_session",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "CHECKBOX",
    "name": "checkSEOdata",
    "checkboxText": "Add SEO data in the push",
    "simpleValueType": true,
    "help": "Check to show some fields related to SEO data that you can choose to add on the dataLayer push. NOTE: you will need to add a variable that holds the data you want to push for each of these fields, excepting title field."
  },
  {
    "type": "GROUP",
    "name": "scrapOptions",
    "displayName": "SEO fields to inform in the push",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "scrapOptionTitle",
        "checkboxText": "Title",
        "simpleValueType": true
      },
      {
        "type": "CHECKBOX",
        "name": "scrapOptionDescription",
        "checkboxText": "Description",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "descriptionVar",
        "displayName": "Description variable",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "scrapOptionDescription",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "scrapOptionH1",
        "checkboxText": "H1",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "h1Var",
        "displayName": "H1 variable",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "scrapOptionH1",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "scrapOptionMetarobots",
        "checkboxText": "Metarobots",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "metarobotsVar",
        "displayName": "Metarobots variable",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "scrapOptionMetarobots",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "scrapOptionCanonical",
        "checkboxText": "Canonical",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "canonicalVar",
        "displayName": "Canonical variable",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "scrapOptionCanonical",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      }
    ],
    "enablingConditions": [
      {
        "paramName": "checkSEOdata",
        "paramValue": true,
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "sessionTime",
    "displayName": "Session time",
    "simpleValueType": true,
    "help": "The time in minutes that a session will last. Past this time, a new page load by the same user will trigger a new push.",
    "defaultValue": 10
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Require needed APIs.
const getReferrerUrl = require('getReferrerUrl');
const localStorage = require('localStorage');
const createQueue = require('createQueue');
const getUrl = require('getUrl');
const JSON = require('JSON');
const getTimestampMillis = require('getTimestampMillis');
const readTitle = require('readTitle');
const makeNumber = require('makeNumber');
const log = require('logToConsole');

// Global variables.
const referrer = getReferrerUrl();
const referrerHost = getReferrerUrl('host');
const referrerParts = referrerHost.split('.');
const currentDate = getTimestampMillis()/60000; //ms to minutes

// START PROCESS
// If referrer is valid (from google)...
if(referrerParts && referrerParts.length && referrerParts.length >= 2 && 
   referrerParts[0] === 'www' && referrerParts[1] == "google") {
  // Check referrer is not recent.
  let validReferrer = true;
  const oldKeyValue = localStorage.getItem('sessionReferrers');
  if (oldKeyValue) {
    let cookieJSON = JSON.parse(oldKeyValue);
    if(cookieJSON[referrer]) {
      const oldDate = cookieJSON[referrer];   
      const sessionTime = makeNumber(data.sessionTime) || 10;
      if  (currentDate - oldDate < sessionTime) { // If session time has passed...
        // Too recent, invalid.
        validReferrer = false;
      }
    }
  }
  if(validReferrer) { // If referrer is indeed valid...
    // Check there are no utm or gclid parameters in the query.
    let parameterFound = false;
    const urlQuery = getUrl('query');
    if (urlQuery) {
      const urlParameters = urlQuery.split('&');
      for(let i=0; i<urlParameters.length; i++) {
        const urlParameterParts = urlParameters.split('=');
        if(urlParameterParts) {
          const urlParameterName = urlParameterParts[0];
          if (urlParameterName === 'gclid' || urlParameterName.indexOf('utm_') != -1) 
            parameterFound = true;
            break;
        }
      }
    }
    if (!parameterFound) {
      let cookieJSON = {};
      if (oldKeyValue) {
        // Cookie exists, so take the old value.
        cookieJSON = JSON.parse(oldKeyValue);
      }
      
      // Set cookie in local storage.
      cookieJSON[referrer] = currentDate;
      localStorage.setItem('sessionReferrers', JSON.stringify(cookieJSON));
       
      // Build object to push.
      let objectToPush = {'event': data.pushedEventName || 'ik_seo_session'};
      if(data.scrapOptionTitle === true) objectToPush.title = readTitle();
      if(data.scrapOptionDescription === true) objectToPush.description = data.descriptionVar;
      if(data.scrapOptionH1 === true) objectToPush.h1 = data.h1Var;
      if(data.scrapOptionMetarobots === true) objectToPush.metarobots = data.metarobotsVar;
      if(data.scrapOptionCanonical === true) objectToPush.canonical = data.canonicalVar;
      
      // Push object into the dataLayer.
      const dataLayerPush = createQueue('dataLayer');
      dataLayerPush(objectToPush);
    }
     
  }
  
}

// Ejecute data.gtmOnSuccess cuando la etiqueta haya finalizado.
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_referrer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_local_storage",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "sessionReferrers"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_title",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 15/6/2022, 11:44:40


